import{l as O,r as i,s as Y,f as y,o as b,a,u as W,m as I,w as g,b as e,g as L,i as V,p as H,t as p,e as B,v as U,F as $,q as R,d as G,W as J,B as x}from"./app-lBFWFbO3.js";import{A as K}from"./AuthenticatedLayout-BAQR-N2z.js";import{_ as Q}from"./Modal-B7Ry9LA4.js";import{_}from"./InputLabel-H8ZK7EIA.js";import{_ as k}from"./TextInput-BP2iDJ_P.js";import{P as X}from"./PrimaryButton-B4gQPJ4i.js";import{_ as Z}from"./SecondaryButton-CKTZP05A.js";import{_ as ee}from"./Pagination-B1ZOkbJe.js";import"./debounce-DS9xtVAQ.js";import{S as c}from"./sweetalert2.esm.all-B0Dix5B2.js";const te={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},se={class:"p-6 text-gray-900"},oe={class:"sticky top-0 z-10 bg-white pb-4 mb-4 border-b"},le={class:"flex justify-between items-center"},ae={class:"flex items-center gap-4"},re={class:"relative"},ie={class:"relative"},ne={class:"overflow-x-auto overflow-y-auto max-h-[calc(100vh-300px)]"},de={class:"min-w-full divide-y divide-gray-200"},ue={class:"bg-gray-50 sticky top-0 z-10"},pe={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},ce={class:"bg-white divide-y divide-gray-200"},me={class:"px-6 py-4 whitespace-nowrap"},fe=["value"],ve={class:"px-6 py-4 whitespace-nowrap"},ge={class:"px-6 py-4 whitespace-nowrap"},xe={class:"px-6 py-4 whitespace-nowrap"},he={class:"px-6 py-4 whitespace-nowrap"},we={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},ye=["onClick"],be=["onClick"],_e={class:"mt-4 sticky bottom-0 bg-white pt-4 border-t"},ke={class:"p-6"},Ce={class:"text-lg font-medium text-gray-900 mb-4"},Se={class:"grid grid-cols-2 gap-4"},Ve={class:"flex items-center justify-end mt-6 gap-4"},qe={__name:"Index",props:{suppliers:Object,filters:Object},setup(D){var A;const h=O(),m=D,N=i({}),f=i(((A=m.filters)==null?void 0:A.search)||""),w=i(!1);i(!1),i(null);const d=i([]),v=i(!1),r=i({id:"",name:"",contact_person:"",email:"",phone:""}),E=()=>{r.value={id:"",name:"",contact_person:"",email:"",phone:""},N.value={}};function M(){const o={};f.value&&(o.search=f.value),J.get(route("supplies.index"),o,{preserveState:!0,preserveScroll:!0,only:["suppliers"]})}const F=()=>{E(),w.value=!0},j=o=>{r.value={...o},w.value=!0},C=()=>{w.value=!1,E()},u=i(!1),q=async()=>{u.value=!0,await x.post(route("suppliers.store"),r.value).then(o=>{u.value=!1,h.success(o.data),C(),M()}).catch(o=>{console.log(o),u.value=!1,h.error(o.response.data)})},P=async o=>{(await c.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"})).isConfirmed&&T(o)},T=async o=>{var t,n;try{await x.delete(`/suppliers/${o.id}`),await c.fire({icon:"success",title:"Deleted!",text:"Supplier has been deleted."});const l=await x.get("/suppliers");m.suppliers=l.data}catch(l){(n=(t=l.response)==null?void 0:t.data)!=null&&n.errors?Object.keys(l.response.data.errors).forEach(s=>{h.error(l.response.data.errors[s][0])}):c.fire({icon:"error",title:"Error",text:"Failed to delete supplier"})}},z=async()=>{var t,n;if((await c.fire({title:"Are you sure?",text:`You are about to delete ${d.value.length} suppliers. This cannot be undone!`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete them!"})).isConfirmed)try{await x.post("/suppliers/bulk-delete",{ids:d.value}),await c.fire({icon:"success",title:"Deleted!",text:"Selected suppliers have been deleted."}),d.value=[],v.value=!1;const l=await x.get("/suppliers");m.suppliers=l.data}catch(l){(n=(t=l.response)==null?void 0:t.data)!=null&&n.errors?Object.keys(l.response.data.errors).forEach(s=>{h.error(l.response.data.errors[s][0])}):c.fire({icon:"error",title:"Error",text:"Failed to delete suppliers"})}};return Y([()=>f.value],()=>{M()}),(o,t)=>(b(),y($,null,[a(W(I),{title:"Suppliers"}),a(K,{title:"Manage Your Supplies",description:"Ensuring an Optimcal Flow of Essentials Resource",img:"/assets/images/supplies.png"},{header:g(()=>t[9]||(t[9]=[e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Suppliers",-1)])),default:g(()=>{var n,l;return[e("div",te,[e("div",se,[e("div",oe,[e("div",le,[e("div",ae,[e("div",re,[V(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=s=>f.value=s),onInput:t[1]||(t[1]=(...s)=>o.debouncedSearch&&o.debouncedSearch(...s)),placeholder:"Search by name, email or phone...",class:"pl-10 pr-4 py-2 rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50 w-80"},null,544),[[H,f.value]]),t[10]||(t[10]=e("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[e("svg",{class:"h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z","clip-rule":"evenodd"})])],-1))]),d.value.length>0?(b(),y("button",{key:0,onClick:z,class:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors duration-200"}," Delete Selected ("+p(d.value.length)+") ",1)):L("",!0)]),e("button",{onClick:F,class:"px-4 py-2 bg-gray-800 text-white rounded-md hover:bg-gray-700 transition-colors duration-200 flex items-center gap-2"},t[11]||(t[11]=[e("svg",{class:"w-5 h-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z","clip-rule":"evenodd"})],-1),B(" Add New Supplier ")]))])]),e("div",ie,[e("div",ne,[e("table",de,[e("thead",ue,[e("tr",null,[e("th",pe,[V(e("input",{type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=s=>v.value=s),onChange:t[3]||(t[3]=(...s)=>v.value&&v.value(...s)),class:"rounded border-gray-300 text-indigo-600 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"},null,544),[[U,v.value]])]),t[12]||(t[12]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Name ",-1)),t[13]||(t[13]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Contact Person",-1)),t[14]||(t[14]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Email ",-1)),t[15]||(t[15]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Phone ",-1)),t[16]||(t[16]=e("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions",-1))])]),e("tbody",ce,[(b(!0),y($,null,R((n=m.suppliers)==null?void 0:n.data,s=>(b(),y("tr",{key:s.id},[e("td",me,[V(e("input",{type:"checkbox",value:s.id,"onUpdate:modelValue":t[4]||(t[4]=S=>d.value=S),class:"rounded border-gray-300 text-indigo-600 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"},null,8,fe),[[U,d.value]])]),e("td",ve,p(s.name),1),e("td",ge,p(s.contact_person),1),e("td",xe,p(s.email),1),e("td",he,p(s.phone),1),e("td",we,[e("button",{onClick:S=>j(s),class:"text-indigo-600 hover:text-indigo-900 mr-2 transition-colors duration-200"}," Edit ",8,ye),e("button",{onClick:S=>P(s),class:"text-red-600 hover:text-red-900 transition-colors duration-200"}," Delete ",8,be)])]))),128))])])])]),e("div",_e,[a(ee,{links:(l=m.suppliers)==null?void 0:l.links},null,8,["links"])]),a(Q,{show:w.value,onClose:C,maxWidth:"2xl"},{default:g(()=>[e("div",ke,[e("h2",Ce,p(r.value.id?"Edit Supplier":"Add New Supplier"),1),e("form",{onSubmit:G(q,["prevent"])},[e("div",Se,[e("div",null,[a(_,{for:"name",value:"Name"}),a(k,{id:"name",type:"text",modelValue:r.value.name,"onUpdate:modelValue":t[5]||(t[5]=s=>r.value.name=s),class:"mt-1 block w-full",placeholder:"Enter supplier name",required:""},null,8,["modelValue"])]),e("div",null,[a(_,{for:"contact_person",value:"Contact Person"}),a(k,{id:"contact_person",type:"text",modelValue:r.value.contact_person,"onUpdate:modelValue":t[6]||(t[6]=s=>r.value.contact_person=s),class:"mt-1 block w-full",placeholder:"Enter contact person name",required:""},null,8,["modelValue"])]),e("div",null,[a(_,{for:"email",value:"Email"}),a(k,{id:"email",type:"email",modelValue:r.value.email,"onUpdate:modelValue":t[7]||(t[7]=s=>r.value.email=s),class:"mt-1 block w-full",placeholder:"Enter email address",required:""},null,8,["modelValue"])]),e("div",null,[a(_,{for:"phone",value:"Phone"}),a(k,{id:"phone",type:"text",modelValue:r.value.phone,"onUpdate:modelValue":t[8]||(t[8]=s=>r.value.phone=s),class:"mt-1 block w-full",placeholder:"Enter phone number",required:""},null,8,["modelValue"])])]),e("div",Ve,[a(Z,{onClick:C,disabled:u.value},{default:g(()=>t[17]||(t[17]=[B("Cancel")])),_:1},8,["disabled"]),a(X,{disabled:u.value},{default:g(()=>[B(p(r.value.id?u.value?"Updating...":"Update":u.value?"Creating...":"Create"),1)]),_:1},8,["disabled"])])],32)])]),_:1},8,["show"])])])]}),_:1})],64))}};export{qe as default};
