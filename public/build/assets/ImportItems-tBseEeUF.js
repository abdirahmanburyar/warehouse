import{l as E,r as p,c as M,o as i,w as n,a as u,u as d,b as t,e as g,d as F,f as m,g as v,t as y,B as N}from"./app-lBFWFbO3.js";import{Y as O,h as C,G as S,V as D,S as T}from"./transition-CVw4BkCX.js";const z={class:"fixed inset-0 overflow-y-auto"},A={class:"flex min-h-full items-center justify-center p-4 text-center"},P={class:"mt-4"},G={class:"mt-1 flex items-center justify-center w-full"},U={class:"flex flex-col items-center justify-center w-full h-32 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100"},Y={class:"flex flex-col items-center justify-center pt-5 pb-6"},H={key:0,class:"mb-2 text-sm text-gray-500"},L={key:1,class:"text-xs text-gray-500"},Q={key:2,class:"text-sm text-gray-800 font-medium"},q={key:0,class:"mt-1 text-sm text-red-600"},J={class:"flex justify-end gap-3"},K=["disabled"],R=["disabled"],W={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},$={__name:"ImportItems",props:{isOpen:Boolean,purchaseOrderId:Number},emits:["close","imported","uploaded"],setup(h,{emit:I}){const c=E(),b=h,f=I,j=p(null),s=p(null),r=p({}),a=p(!1),B=l=>{const e=l.target.files[0];e&&e.type==="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"?(s.value=e,r.value={}):(c.error("Please select a valid Excel file (.xlsx)"),l.target.value="",s.value=null)},x=()=>{s.value=null,r.value={},f("close")},V=async()=>{var e,w,_,k;if(!s.value||a.value)return;a.value=!0,r.value={};const l=new FormData;l.append("file",s.value,s.value.name),l.append("purchase_order_id",b.purchaseOrderId);try{const o=await N.post(route("purchase-orders.import-items",b.purchaseOrderId),l,{headers:{"Content-Type":"multipart/form-data",Accept:"application/json"}});o.data.success?(c.success(o.data.message||"Items imported successfully"),f("imported"),f("uploaded"),x()):c.error(o.data.message||"Failed to import items")}catch(o){console.error("Import error:",o),(w=(e=o.response)==null?void 0:e.data)!=null&&w.errors?(r.value=o.response.data.errors,c.error("Please check the form for errors")):c.error(((k=(_=o.response)==null?void 0:_.data)==null?void 0:k.message)||"Error importing items")}finally{a.value=!1}};return(l,e)=>(i(),M(d(T),{appear:"",show:h.isOpen,as:"template"},{default:n(()=>[u(d(O),{as:"div",class:"relative z-[60]",onClose:x},{default:n(()=>[u(d(C),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:n(()=>e[0]||(e[0]=[t("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)])),_:1}),t("div",z,[t("div",A,[u(d(C),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:n(()=>[u(d(S),{class:"w-full max-w-2xl transform overflow-hidden rounded-2xl bg-white p-6 text-left align-middle shadow-xl transition-all"},{default:n(()=>[u(d(D),{as:"h3",class:"text-lg font-medium leading-6 text-gray-900"},{default:n(()=>e[1]||(e[1]=[g(" Import Items from Excel ")])),_:1}),t("div",P,[t("form",{onSubmit:F(V,["prevent"]),enctype:"multipart/form-data",class:"space-y-4"},[t("div",null,[e[4]||(e[4]=t("label",{class:"block text-sm font-medium text-gray-700"},"Excel File",-1)),t("div",G,[t("label",U,[t("div",Y,[e[3]||(e[3]=t("svg",{class:"w-8 h-8 mb-4 text-gray-500","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 20 16"},[t("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 13h3a3 3 0 0 0 0-6h-.025A5.56 5.56 0 0 0 16 6.5 5.5 5.5 0 0 0 5.207 5.021C5.137 5.017 5.071 5 5 5a4 4 0 0 0 0 8h2.167M10 15V6m0 0L8 8m2-2 2 2"})],-1)),s.value?v("",!0):(i(),m("p",H,e[2]||(e[2]=[t("span",{class:"font-semibold"},"Click to upload",-1),g(" or drag and drop")]))),s.value?(i(),m("p",Q,y(s.value.name),1)):(i(),m("p",L,"Excel"))]),t("input",{type:"file",class:"hidden",accept:".xlsx",onChange:B,ref_key:"fileInput",ref:j,name:"file"},null,544)])]),r.value.file?(i(),m("div",q,y(r.value.file),1)):v("",!0),e[5]||(e[5]=t("div",{class:"text-sm text-gray-500 mt-1"}," Please upload an Excel file (.xlsx) with the following columns: Item Code, Item Description, UoM, Quantity, Unit Cost, Total Cost ",-1))]),t("div",J,[t("button",{type:"button",class:"inline-flex justify-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",onClick:x,disabled:a.value}," Cancel ",8,K),t("button",{type:"submit",disabled:!s.value||a.value,class:"inline-flex justify-center rounded-md border border-transparent bg-indigo-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 disabled:opacity-50"},[a.value?(i(),m("svg",W,e[6]||(e[6]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):v("",!0),g(" "+y(a.value?"Importing...":"Import"),1)],8,R)])],32)])]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"]))}};export{$ as default};
